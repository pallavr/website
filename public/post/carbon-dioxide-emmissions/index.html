<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.32.2" />
  <meta name="author" content="Pallav Routh">

  
  
  
  
    
      
    
  
  <meta name="description" content="body {text-align: justify}MotivationGlobal warming is real. 100%. NASA came out with a beautiful simulation of carbon dioxide emissions for countries all around the world. Ever since then, I was eager to replicate this in R. Of course I couldn’t make it as beautiful as theirs but nevertheless, the final picture I made came out great by R standards. I found some good data on carbon dioxide emissions from the WRI website.">

  
  <link rel="alternate" hreflang="en-us" href="/post/carbon-dioxide-emmissions/">

  


  

  
  
  <meta name="theme-color" content="#0095eb">
  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Home">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Home">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/carbon-dioxide-emmissions/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@pallav_routh">
  <meta property="twitter:creator" content="@pallav_routh">
  
  <meta property="og:site_name" content="Home">
  <meta property="og:url" content="/post/carbon-dioxide-emmissions/">
  <meta property="og:title" content="Carbon Dioxide Emmissions | Home">
  <meta property="og:description" content="body {text-align: justify}MotivationGlobal warming is real. 100%. NASA came out with a beautiful simulation of carbon dioxide emissions for countries all around the world. Ever since then, I was eager to replicate this in R. Of course I couldn’t make it as beautiful as theirs but nevertheless, the final picture I made came out great by R standards. I found some good data on carbon dioxide emissions from the WRI website."><meta property="og:image" content="/img/headers/carbon.jpg">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-01-06T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2018-01-06T00:00:00&#43;00:00">
  

  

  <title>Carbon Dioxide Emmissions | Home</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/"><img src="/img/pic.png" alt="Home"></a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        

        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#publications_selected">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  
<div class="article-header">
  <img src="/img/headers/carbon.jpg" class="article-banner" itemprop="image">
  
</div>



  <div class="article-container">
    <div class="article-inner">
      <h1 itemprop="name">Carbon Dioxide Emmissions</h1>

      

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2018-01-06 00:00:00 &#43;0000 UTC" itemprop="datePublished dateModified">
      Jan 6, 2018
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Pallav Routh">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    4 min read
  </span>
  

  
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/visualization">visualization</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Carbon%20Dioxide%20Emmissions&amp;url=%2fpost%2fcarbon-dioxide-emmissions%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fcarbon-dioxide-emmissions%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fcarbon-dioxide-emmissions%2f&amp;title=Carbon%20Dioxide%20Emmissions"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fcarbon-dioxide-emmissions%2f&amp;title=Carbon%20Dioxide%20Emmissions"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Carbon%20Dioxide%20Emmissions&amp;body=%2fpost%2fcarbon-dioxide-emmissions%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


      <div class="article-style" itemprop="articleBody">
        <style>
body {
text-align: justify}
</style>
<div id="motivation" class="section level1">
<h1>Motivation</h1>
<p>Global warming is real. 100%. NASA came out with a <a href="https://www.nasa.gov/press/goddard/2014/november/nasa-computer-model-provides-a-new-portrait-of-carbon-dioxide/">beautiful simulation</a> of carbon dioxide emissions for countries all around the world. Ever since then, I was eager to replicate this in R. Of course I couldn’t make it as beautiful as theirs but nevertheless, the final picture I made came out great by R standards. I found some good data on carbon dioxide emissions from the WRI <a href="http://datasets.wri.org/dataset/cait-country">website</a>. I was able to use the data to create an animation with <code>ggplot2</code>. A great way to perform animations with <code>ggplot2</code> is to use the <code>gganimate</code> package. But the package is filled with bugs and fails to run on many occasions. The <code>gganimate</code> function is just a wrapper around image magick. You can easily create the frames, save them in a drive and just run image magick from your console. But if you do manage to make <code>gganimate</code> run on your R-studio then go ahead use that option instead.</p>
</div>
<div id="the-libraries" class="section level1">
<h1>The libraries</h1>
<pre class="r"><code>library(readr)
library(ggplot2)
library(dplyr)</code></pre>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<div id="carbon" class="section level2">
<h2>Carbon</h2>
<p>This is the carbon dioxide emission data by country and Year.</p>
<pre class="r"><code>carbon &lt;- read.csv(&quot;C:/Users/routh/Desktop/Study Materials/Projects/Carbon Emmissions/carbon.csv&quot;)
colnames(carbon)[3] &lt;- &quot;emission&quot;

knitr::kable(tail(carbon,5))</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Country</th>
<th align="right">Year</th>
<th align="right">emission</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>30828</td>
<td align="left">Vietnam</td>
<td align="right">2013</td>
<td align="right">160.0705</td>
</tr>
<tr class="even">
<td>30829</td>
<td align="left">World</td>
<td align="right">2013</td>
<td align="right">34389.5959</td>
</tr>
<tr class="odd">
<td>30830</td>
<td align="left">Yemen</td>
<td align="right">2013</td>
<td align="right">25.9220</td>
</tr>
<tr class="even">
<td>30831</td>
<td align="left">Zambia</td>
<td align="right">2013</td>
<td align="right">3.4472</td>
</tr>
<tr class="odd">
<td>30832</td>
<td align="left">Zimbabwe</td>
<td align="right">2013</td>
<td align="right">12.3572</td>
</tr>
</tbody>
</table>
<pre class="r"><code># rename USA and RUSSIA
carbon$Country &lt;- gsub(&quot;United States&quot;, &quot;USA&quot;, carbon$Country)
carbon$Country &lt;- gsub(&quot;Russian Federation&quot;, &quot;Russia&quot;, carbon$Country)</code></pre>
</div>
<div id="world-map" class="section level2">
<h2>World Map</h2>
<p>World data with latitude and longitude values is easily available using the <code>map_data</code> function. You need to convert it into a data frame. I removed Antarctica because data for carbon dioxide emissions was not available for Antarctica.</p>
<pre class="r"><code>world &lt;- map_data(&#39;world&#39;) %&gt;% 
                   data.frame() %&gt;%
                   select(1:3,5) %&gt;%
                   filter(region != &quot;Antarctica&quot;) %&gt;%
                   rename(Country = region)

knitr::kable(head(world,5))</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">long</th>
<th align="right">lat</th>
<th align="right">group</th>
<th align="left">Country</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-69.89912</td>
<td align="right">12.45200</td>
<td align="right">1</td>
<td align="left">Aruba</td>
</tr>
<tr class="even">
<td align="right">-69.89571</td>
<td align="right">12.42300</td>
<td align="right">1</td>
<td align="left">Aruba</td>
</tr>
<tr class="odd">
<td align="right">-69.94219</td>
<td align="right">12.43853</td>
<td align="right">1</td>
<td align="left">Aruba</td>
</tr>
<tr class="even">
<td align="right">-70.00415</td>
<td align="right">12.50049</td>
<td align="right">1</td>
<td align="left">Aruba</td>
</tr>
<tr class="odd">
<td align="right">-70.06612</td>
<td align="right">12.54697</td>
<td align="right">1</td>
<td align="left">Aruba</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="transformations" class="section level1">
<h1>Transformations</h1>
<p>I noticed there was a lot of missing values for the years before 1950. So I filtered those years out. I also converted <code>Country</code> into factors. <em>Please don’t convert the years into factors</em>. We would take advantage of the numeric nature to loop through the years and create separate images.</p>
<pre class="r"><code>carbon &lt;- carbon %&gt;%
              filter(Year &gt; 1949) %&gt;%
              mutate(Country = as.factor(Country))
              

carbon[is.na(carbon)] &lt;- 0</code></pre>
</div>
<div id="visualization" class="section level1">
<h1>Visualization</h1>
<p>The following codes would create 64 frame (or plots), one for each Year and save it to the current working directory. It’s pretty straight forward. The first few lines is just a fancy way to create the names for the <code>jpeg</code>s as they are created. Then I extract the <code>Year</code> one by one and combine it with the world data. The penultimate step is to create the plot in <code>ggplot2</code>. The final trick is to use the <code>ggsave</code> function to save the <code>jpegs</code>.</p>
<p>After you have saved the plots in the current working directory, you need to download <a href="https://www.imagemagick.org/script/download.php">imagemagick</a> on your device. Then you need to go your command line (cmd for windows users) and after that your need to navigate to the working directory using <code>cd</code>. After you change the directory, you need to type this:<br />
<code>magick convert *.jpeg -delay 10 -loop 0 carbon.gif</code>.</p>
<pre class="r"><code>frames &lt;- length(unique(carbon$Year))

windowsFonts(Times=windowsFont(&quot;Times New Roman&quot;))

for(i in 1:frames){
  # creating a name for each plot file with leading zeros
  if (i &lt; 10) {name = paste(&#39;000&#39;,i,&#39;.jpeg&#39;,sep=&#39;&#39;)}
  if (i &lt; 100 &amp;&amp; i &gt;= 10) {name = paste(&#39;00&#39;,i,&#39;.jpeg&#39;, sep=&#39;&#39;)}
  if (i &gt;= 100) {name = paste(&#39;0&#39;, i,&#39;.jpeg&#39;, sep=&#39;&#39;)}
  
  data &lt;- carbon %&gt;%
               filter(Year == (1949+i))
  
  combine &lt;- left_join(world,data,&quot;Country&quot;)
  
  # create plot
  g &lt;- ggplot(combine, aes(x = long,y = lat,group = group))+
           geom_polygon(aes(fill = emission))+
           geom_path()+ 
           scale_fill_gradientn( name = &quot;Carbon Emmissions Level&quot;,
                                 colours = rev(heat.colors(10)),
                                 na.value = &quot;grey90&quot;,
                                 limits = c(0, 7e3),
                                 guide = guide_legend( keyheight = unit(3, units = &quot;mm&quot;), 
                                                       keywidth = unit(12, units = &quot;mm&quot;),
                                                       label.position = &quot;bottom&quot;, 
                                                       title.position = &#39;top&#39;, 
                                                       nrow = 1))+
           labs(title = paste(&#39;Emissions in the year&#39;,1949+i),
                subtitle = &quot;Carbon Dioxide Emmission since 1950&quot;, 
                caption = &quot;World Resources Institute&quot;,
                x = &quot;Longitude&quot;,y = &quot;Latitude&quot;)+
           theme(text = element_text(color = &quot;#22211d&quot;), 
                 plot.background = element_rect(fill = &quot;#f5f5f2&quot;, color = NA), 
                 panel.background = element_rect(fill = &quot;#f5f5f2&quot;, color = NA), 
                 legend.background = element_rect(fill = &quot;#f5f5f2&quot;, color = NA),
                 plot.title = element_text(family = &quot;Times&quot;,
                                           size = 18, 
                                           hjust = 0.01, 
                                           color = &quot;#4e4d47&quot;, 
                                           margin = margin(b = -0.1, t = 0.4, l = 2, unit = &quot;cm&quot;)),
                plot.subtitle = element_text(size= 15, 
                                             hjust = 0.01, 
                                             color = &quot;#4e4d47&quot;, 
                                             margin = margin(b = -0.1, t = 0.43, l = 2, unit = &quot;cm&quot;)),
                plot.caption = element_text( size = 12, 
                                             color = &quot;#4e4d47&quot;, 
                                             margin = margin(b = 0.3, r=-99, unit = &quot;cm&quot;) ),
                legend.position = c(0.7, 0.09))
  
  # print and save
  # ggsave(name,width = 40, height = 20, units = &quot;cm&quot;) You would need to uncomment this
}</code></pre>
<p>You can find the gif <a href="https://gfycat.com/gifs/detail/ImaginaryDistortedAlaskajingle">here</a></p>
<p>Beautiful!</p>
<p>Its not as fancy as the NASA plot but nonetheless, it’s pretty accurate. Notice the colors for USA and China. Right towards the end USA manages to reduce the emission levels but China’s emission levels keep on rising!</p>
</div>

      </div>

      


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/animation">animation</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/ggplot2">ggplot2</a>
  
</div>



    </div>
  </div>

</article>



<div class="article-container article-widget">
  <div class="hr-light"></div>
  <h3>Related</h3>
  <ul>
    
    <li><a href="/post/nobel-laureates/">Nobel Laureates</a></li>
    
  </ul>
</div>




<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

