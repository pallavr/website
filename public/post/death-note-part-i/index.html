<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.32.2" />
  <meta name="author" content="Pallav Routh">

  
  
  
  
    
      
    
  
  <meta name="description" content="body {text-align: justify}Death Note is a Japanese manga series depicting an evil book that would kill people if their names were written on it. Now, there are no such books in the real world, but a field of study called Survival Analysis allows statisticians to measure and predict the risk(s) individuals will face. It also allows statisticians to measure the duration of life until an event(s) occurs.">

  
  <link rel="alternate" hreflang="en-us" href="/post/death-note-part-i/">

  


  

  
  
  <meta name="theme-color" content="#0095eb">
  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Home">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Home">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/death-note-part-i/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@pallav_routh">
  <meta property="twitter:creator" content="@pallav_routh">
  
  <meta property="og:site_name" content="Home">
  <meta property="og:url" content="/post/death-note-part-i/">
  <meta property="og:title" content="Death Note (Part I) | Home">
  <meta property="og:description" content="body {text-align: justify}Death Note is a Japanese manga series depicting an evil book that would kill people if their names were written on it. Now, there are no such books in the real world, but a field of study called Survival Analysis allows statisticians to measure and predict the risk(s) individuals will face. It also allows statisticians to measure the duration of life until an event(s) occurs."><meta property="og:image" content="/img/headers/death.jpg">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-01-14T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2018-01-14T00:00:00&#43;00:00">
  

  

  <title>Death Note (Part I) | Home</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/"><img src="/img/pic.png" alt="Home"></a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        

        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#publications">
            
            <span>Research</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  
<div class="article-header">
  <img src="/img/headers/death.jpg" class="article-banner" itemprop="image">
  
</div>



  <div class="article-container">
    <div class="article-inner">
      <h1 itemprop="name">Death Note (Part I)</h1>

      

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2018-01-14 00:00:00 &#43;0000 UTC" itemprop="datePublished dateModified">
      Jan 14, 2018
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Pallav Routh">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    22 min read
  </span>
  

  
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/predictive-analytics">predictive analytics</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Death%20Note%20%28Part%20I%29&amp;url=%2fpost%2fdeath-note-part-i%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fdeath-note-part-i%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fdeath-note-part-i%2f&amp;title=Death%20Note%20%28Part%20I%29"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fdeath-note-part-i%2f&amp;title=Death%20Note%20%28Part%20I%29"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Death%20Note%20%28Part%20I%29&amp;body=%2fpost%2fdeath-note-part-i%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


      <div class="article-style" itemprop="articleBody">
        <style>
body {
text-align: justify}
</style>
<p><em>Death Note</em> is a Japanese manga series depicting an evil book that would kill people if their names were written on it. Now, there are no such books in the real world, but a field of study called <strong>Survival Analysis</strong> allows statisticians to measure and predict the risk(s) individuals will face. It also allows statisticians to measure the duration of life until an event(s) occurs. The earliest forms of survival analysis originated in the 17th century in the form of <strong>life tables</strong>. It was popularized by the work of the infamous <em>D.R.Cox</em> and his <strong>semi-parametric</strong> models.</p>
<div id="the-libraries" class="section level1">
<h1>The libraries</h1>
<pre class="r"><code>library(invGauss) # has the data
library(dplyr) # data manipulation
library(tidyr) # data manipulation
library(ggplot2) # data viz
library(ggfortify)
library(survival) # survival analysis</code></pre>
</div>
<div id="the-data" class="section level1">
<h1>The Data</h1>
<p>It’s very difficult to obtain time-to-event data on the internet. One interesting data set I found is shipped with the <code>invGauss</code> package. The data set is about cancer in the oropharynx. This data set was given by Kalbfleisch and Prentice and has 192 observations or patients with carcinoma of the oropharynx carried out by the Radiation Therapy Oncology Group in the United States.</p>
<ul>
<li><strong>CASE:</strong> Case Number</li>
<li><strong>INST:</strong> Participating Institution</li>
<li><strong>SEX:</strong> 1=male, 2=female</li>
<li><strong>TX:</strong> Treatment: 1=standard, 2=test</li>
<li><strong>GRADE:</strong> 1=well differentiated, 2=moderately differentiated,3=poorly differentiated, 9=missing</li>
<li><strong>AGE:</strong> In years at time of diagnosis</li>
<li><strong>COND:</strong> Condition: 1=no disability, 2=restricted work, 3=requires assistance with self care, 4=bed confined, 9=missing</li>
<li><strong>SITE:</strong> 1=facial arch, 2=tonsillar fossa, 3=posterior pillar,4=pharyngeal tongue, 5=posterior wall</li>
<li><strong>T_STAGE:</strong> 1=primary tumor measuring 2 cm or less in largest diameter,2=primary tumor measuring 2 cm to 4 cm in largest diameter with minimal infiltration in depth, 3=primary tumor measuring more than 4 cm, 4=massive invasive tumor</li>
<li><strong>N_STAGE:</strong> 0=no clinical evidence of node metastases, 1=single positive node 3 cm or less in diameter, not fixed, 2=single positive node more than 3 cm in diameter, not fixed, 3=multiple positive nodes or fixed positive nodes</li>
<li><strong>ENTRY_DT:</strong> Date of study entry: Day of year and year, dddyy</li>
<li><strong>STATUS:</strong> 0=censored, 1=dead</li>
<li><strong>TIME:</strong> Survival time in days from day of diagnosis</li>
</ul>
<pre class="r"><code>data(&quot;d.oropha.rec&quot;)
data &lt;- d.oropha.rec</code></pre>
</div>
<div id="elements-of-survival-analysis" class="section level1">
<h1>Elements of Survival analysis</h1>
<div id="survival-time-and-event" class="section level2">
<h2>Survival Time and Event</h2>
<p>The two most important measures in survival studies include:</p>
<ul>
<li><p>The <strong>time to death</strong> is a number (in days, week or years) that reflects the number of time intervals until which the person experiences the event. Let this be represented by $ t_i $ or <em>event time</em>.</p></li>
<li><p>The <strong>status</strong> of the patient is usually a number that identifies whether or not the person has experienced the event. Typically, “0” is used to represent observations that are active (or censored) while “1” is used to represent patients who has experienced the event. Let this be represented by $ _i $</p></li>
</ul>
<pre class="r"><code>survivial_object &lt;- with(data,Surv(time = time, event = status, type = c(&quot;right&quot;)))

(survivial_object)[1:30]</code></pre>
<pre><code>##  [1] 1.7287671  0.7397260  0.8958904  0.6657534  2.5095890  4.9945205+
##  [7] 1.7452055  0.6438356  0.6986301  0.5041096  2.9150685  1.1342466 
## [13] 0.5917808  0.8876712  1.3150685  0.6712329  4.2876712+ 1.5342466 
## [19] 1.0301370  2.4958904  0.7643836  0.3945205  2.9917808  0.2575342 
## [25] 0.4849315  4.0328767+ 1.4410959  0.4739726  1.5753425  0.6082192</code></pre>
<p>One can create a survival object in R using the <code>Surv</code> function. A call to the object shows the observations coded as censored (with the <code>+</code>) and non censored. The <code>time</code> column in the data represents the time to death or censoring time.</p>
</div>
<div id="censoring" class="section level2">
<h2>Censoring</h2>
<p>For individuals who have not experienced the event, (called the <strong>censored observations</strong>), we only know the <em>censoring time</em> (represented by $ c_i $) or the time for which the particular observation was under study. Therefore, for such observations we do not know the actual event time. Now imagine any individual <em>i</em> there is a pair of times $ (,)$ but depending on the status we choose either one of them. If the individual experiences the event and <span class="math inline">\(\delta_i=1\)</span> we see <span class="math inline">\(t_i\)</span> but if there is no event and the individual is censored, we see <span class="math inline">\(c_i\)</span>. This information can be compactly represented by <span class="math inline">\((min(t_i,c_i),\delta_i)\)</span>. The <code>status</code> column in the data reflects the status of the individual until event time or censoring time.</p>
</div>
</div>
<div id="kaplan-meier-analysis" class="section level1">
<h1>Kaplan Meier Analysis</h1>
<p>Kaplan-Meier (KM) estimation is a non parametric method of estimating the survival at time <em>t</em>. If you were to order the time in ascending order by the event times <span class="math inline">\(t_i\)</span> and if <span class="math inline">\(\delta_i\)</span> was the number of deaths and let <span class="math inline">\(n_i\)</span> be the number alive just before <span class="math inline">\(t_i\)</span>, then the KM or <strong>product limit estimate</strong> of the survivor function is:</p>
<p><span class="math display">\[S(t) = S(t-1)(1 - \frac{d_t}{n_t} )\]</span></p>
<p>Let’s understand where this comes from. Let <span class="math inline">\(t_1,t_2,t_3...\)</span> be the actual times of death of the <em>n</em> individuals and let <span class="math inline">\(d_1,d_2,d_3....\)</span> represent the number of deaths during those times and let <span class="math inline">\(n_1,n_2,...\)</span> be the people remaining. Now, <span class="math inline">\(n_2 = n_1 - d_1\)</span> and so on. So, intuitively the proportion surviving at time <span class="math inline">\(t=2\)</span> depends on the proportion surviving at <span class="math inline">\(t=1\)</span>. Now for any time interval say $ t [t_1,t_2) $ the survival is:</p>
<p><span class="math display">\[  S(t) = P(T \geq t) = P(\text{survive in}[0,t_1))* P(\text{survive in}[t_1,t]|\text{survive in}[0,t_1))            \]</span></p>
<p><span class="math display">\[  S(t) = 1 * \frac{n_1-d_1}{n_1}  \]</span>. This bring us to:</p>
<p><span class="math display">\[ S(t) = \prod_{i=1}^{n}(1-\frac{d_i}{n_i}) \]</span></p>
<p>The Kaplan-Meier estimate is a step function which <strong>discontinuities or jumps</strong> at the observed death times. If there is no censoring, the K-M estimate coincides with the empirical survival function. The KM estimator can also be nicely interpreted as a NPML estimator. The <code>survfit</code> function in the <code>survival</code> package is used to find out the KM estimates of survival. We can use the <code>summary</code> call to the <code>km</code> object to get the following:</p>
<ul>
<li><strong>n:</strong> the total number of observations.</li>
<li><strong>time:</strong> the time points at which the <span class="math inline">\(S(t)\)</span> is calculated.</li>
<li><strong>n.risk:</strong> the number of observations at risk at time t</li>
<li><strong>n.event:</strong> the number of events that occurred at time t.</li>
<li><strong>n.censor:</strong> the number of censored observations, without an event, at time t.</li>
<li><strong>lower,upper:</strong> lower and upper confidence limits for <span class="math inline">\(S(t)\)</span>, respectively.</li>
<li><strong>strata:</strong> indicates stratification of survival curves. If strata is specified, there are multiple curves in the result. There’s a demonstration later on.</li>
</ul>
<pre class="r"><code>km.fit &lt;- survfit(survivial_object ~ 1, # for a single survival curve
                  data = data)

time &lt;- km.fit$time
summary(km.fit, times = time[1:20])</code></pre>
<pre><code>## Call: survfit(formula = survivial_object ~ 1, data = data)
## 
##    time n.risk n.event survival std.err lower 95% CI upper 95% CI
##  0.0301    192       2    0.990 0.00733        0.975        1.000
##  0.0411    190       1    0.984 0.00895        0.967        1.000
##  0.1041    189       1    0.979 0.01031        0.959        1.000
##  0.2027    188       1    0.974 0.01149        0.952        0.997
##  0.2219    187       1    0.969 0.01256        0.944        0.994
##  0.2438    186       1    0.964 0.01353        0.937        0.990
##  0.2466    185       0    0.964 0.01353        0.937        0.990
##  0.2575    184       1    0.958 0.01443        0.930        0.987
##  0.2712    183       2    0.948 0.01606        0.917        0.980
##  0.2877    181       1    0.943 0.01680        0.910        0.976
##  0.2932    180       1    0.937 0.01751        0.904        0.972
##  0.3068    179       3    0.922 0.01942        0.884        0.961
##  0.3479    176       1    0.916 0.02001        0.878        0.956
##  0.3507    175       1    0.911 0.02057        0.872        0.952
##  0.3562    174       1    0.906 0.02110        0.866        0.948
##  0.3671    173       1    0.901 0.02162        0.859        0.944
##  0.3945    172       1    0.895 0.02212        0.853        0.940
##  0.4027    171       2    0.885 0.02307        0.841        0.931
##  0.4219    169       1    0.880 0.02352        0.835        0.927
##  0.4356    168       1    0.875 0.02395        0.829        0.923</code></pre>
<p>Here’s a neat plot of risk and survival estimated by the <code>survfit</code> function.</p>
<pre class="r"><code>my3cols &lt;- c(&quot;#E7B800&quot;, &quot;#2E9FDF&quot;, &quot;#FC4E07&quot;)
my2cols &lt;- c(&quot;#2E9FDF&quot;, &quot;#FC4E07&quot;)

km.df &lt;- data.frame(
  time = time,
  survival = km.fit$surv,
  dead = km.fit$n.event
)

km.df %&gt;%
  mutate(deaths = cumsum(dead)) %&gt;%
  select(time,survival,deaths) %&gt;%
  gather(key, value, -time) %&gt;%
  ggplot(aes(x = time, y = value))+
  geom_point(col = my2cols[2])+
  geom_line(col = my2cols[2])+
  facet_wrap(~key, scales = &quot;free&quot;)+
  labs(title = &quot;Survival and Event vs Time&quot;)+
  theme_minimal()</code></pre>
<pre><code>## Warning: package &#39;bindrcpp&#39; was built under R version 3.4.2</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div id="km-by-groups" class="section level2">
<h2>KM by groups</h2>
<p>As I mentioned before, we can also create these KM estimates by groups. In R the best way to summarise all the information is to use the <code>ggsurvplot</code> function from the <code>survminer</code> package.</p>
<pre class="r"><code>km.sex.fit &lt;- survfit(survivial_object ~ sex,
                      data = data)

# Using ggsurv package

survminer::ggsurvplot(
   km.sex.fit,               # survfit object with calculated statistics.
   data = data,
   pval = TRUE,              # show p-value of log-rank test.
   conf.int = TRUE,          # show confidence intervals for 
                             # point estimaes of survival curves.
   conf.int.style = &quot;step&quot;,  # customize style of confidence intervals
   xlab = &quot;Time in years&quot;,    # customize X axis label.
   ggtheme = theme_light(),  # customize plot and risk table with a theme.
   risk.table = &quot;abs_pct&quot;,   # absolute number and percentage at risk.
   risk.table.y.text.col = T,# colour risk table text annotations.
   risk.table.y.text = FALSE,# show bars instead of names in text annotations
   ncensor.plot = TRUE,      # plot the number of censored subjects at time t
   surv.median.line = &quot;hv&quot;,  # add the median survival pointer.
   legend.labs = c(&quot;Male&quot;, &quot;Female&quot;),     # change legend labels.
   palette = my2cols         # custom color palettes.
)</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>The Kaplan-Meier plot can be interpreted as follow:</p>
<p>The x axis represents time in years, and the vertical axis (y-axis) shows the proportion of people surviving. The lines represent survival curves of the two groups. <strong>A vertical drop in the curves indicates an event.</strong> The vertical tick mark on the last plot means that a observation was censored at this time and the group it belongs to.</p>
<ul>
<li>At time zero, the survival probability is 1.0 (or 100% of the participants are alive).</li>
<li>At time 1.5 years, the probability of survival is approximately 0.50 (or 55%) for males. It is slightly higher for females.</li>
</ul>
</div>
<div id="interpret-the-output" class="section level2">
<h2>Interpret the output</h2>
<pre class="r"><code>summary(km.sex.fit)$table</code></pre>
<pre><code>##       records n.max n.start events   *rmean *se(rmean)   median   0.95LCL
## sex=1     147   147     147    108 1.854084  0.1360870 1.263014 0.9616438
## sex=2      45    45      45     31 2.096910  0.2490365 1.364384 0.9479452
##        0.95UCL
## sex=1 1.493151
## sex=2       NA</code></pre>
<p>The median survival time for female is indeed higher. The <code>rmean</code> stands for restricted mean survival time. The restricted mean is a measure of average survival from time 0 to a specified time point, and may be estimated as the area under the survival curve up to that point.</p>
<p><strong>Complicated Groups</strong></p>
<p>One can also use facet grids to compare survival curves across complex groups.</p>
<pre class="r"><code>km.sex.treat.fit &lt;- survfit(survivial_object ~ sex + treatm,
                      data = data)

ggsurv &lt;- survminer::ggsurvplot(km.sex.treat.fit, data = data,fun = &quot;cumhaz&quot;, conf.int = TRUE)
   
ggsurv$plot +
  theme_minimal() + 
  theme (legend.position = &quot;right&quot;)+
  facet_grid(sex ~ treatm)</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="hazard" class="section level2">
<h2>Hazard</h2>
<p>In survival literature, the opposite of survival is hazard. Hazard refers to the instantaneous rate of death of the subject at time <span class="math inline">\(t\)</span> conditional on survival to that time. Mathematically,</p>
<p><span class="math display">\[  \lambda(t) = \lim_{\Delta t \to 0} \frac{ \text{Pr}\{(t \leq T \leq t+\Delta t)|T \geq t\}   }{\Delta t} = \frac{f(t)}{S(t)}         \]</span></p>
<p>The numerator in the equation represents the conditional probability that an event will occur within the time interval of <span class="math inline">\([t,t+\Delta t)\)</span> given that it has not occurred before (that is $ T t $). This conditional probability may be represented by a joint probability (Using the axioms of probability: P(AB) = P(A)P(B|A)). The former is represented by $ f(t) $ in the above equation while the latter is $ S(t) $ by definition. Dividing this by the width of the interval gives us a rate (of death) per unit time. Therefore, Hazard and survival have a one to one relationship (and it’s definitely not <strong>1-Survival</strong>).</p>
<p>One can calculate hazard non parametrically using the <strong>Nelson Aalen Estimator</strong>. Mathematically the NE estimator is:</p>
<p><span class="math display">\[  \hat{H(t)} = \sum_{t_i \leq T}\frac{d_i}{n_i}      \]</span></p>
<p>with $ d_{i} $ the number of events at $ t_{i} $ and $ n_{i} $ the total individuals at risk at $ t_{i} $. You can also visualize the hazard using the <code>ggsurvplot</code> function by specifying the value of <code>fun</code> as <code>cumhaz</code>.</p>
<pre class="r"><code>survminer::ggsurvplot(
   km.sex.fit,               # survfit object with calculated statistics.
   data = data,
   fun = &quot;cumhaz&quot;,
   pval = TRUE,              # show p-value of log-rank test.
   conf.int = TRUE,          # show confidence intervals for 
                             # point estimaes of survival curves.
   conf.int.style = &quot;step&quot;,  # customize style of confidence intervals
   xlab = &quot;Time in years&quot;,    # customize X axis label.
   ggtheme = theme_light(),  # customize plot and risk table with a theme.
   risk.table = &quot;abs_pct&quot;,   # absolute number and percentage at risk.
   risk.table.y.text.col = T,# colour risk table text annotations.
   risk.table.y.text = FALSE,# show bars instead of names in text annotations
   ncensor.plot = TRUE,      # plot the number of censored subjects at time t
   legend.labs = c(&quot;Male&quot;, &quot;Female&quot;),     # change legend labels.
   palette = my2cols         # custom color palettes.
)</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="comparing-survival-curves" class="section level2">
<h2>Comparing Survival Curves</h2>
<p>The <strong>Log Rank Test</strong> is the most popular hypothesis test to distinguish two or more survival curves. Basically the LR test compares the Hazard of the two survival curves at every point in time. If you’re interested in the formulation and the derivation of the test statistic, the <a href="https://en.wikipedia.org/wiki/Log-rank_test">wikipedia</a> page has a nice explanation.</p>
<p>The function <code>survdiff()</code> [in survival package] can be used to compute log-rank test comparing two or more survival curves.</p>
<pre class="r"><code>survdiff(survivial_object ~ sex,data = data)</code></pre>
<pre><code>## Call:
## survdiff(formula = survivial_object ~ sex, data = data)
## 
##         N Observed Expected (O-E)^2/E (O-E)^2/V
## sex=1 147      108    103.8     0.174     0.688
## sex=2  45       31     35.2     0.511     0.688
## 
##  Chisq= 0.7  on 1 degrees of freedom, p= 0.407</code></pre>
<p>The function returns a list of components, including:</p>
<ul>
<li><strong>n:</strong> the number of subjects in each group.</li>
<li><strong>obs:</strong> the weighted observed number of events in each group.</li>
<li><strong>exp:</strong> the weighted expected number of events in each group.</li>
<li><strong>chisq:</strong> the chi square statistic for a test of equality.</li>
<li><strong>strata:</strong> optionally, the number of subjects contained in each stratum.</li>
</ul>
<p>The log rank test for difference in survival gives a p-value of p = 0.4, indicating that the sex groups do not differ significantly in survival.</p>
</div>
</div>
<div id="cox-proportional-survival-analysis" class="section level1">
<h1>Cox Proportional Survival Analysis</h1>
<p>The proportional hazards model (introduced by Cox, 1972) is a family of survival models that allow for covariates to be linked to the hazard directly. The first key to this relationship is that its <strong>multiplicative</strong>. This means that we can only allow the logarithm of the hazard to be linked to the covariates by:</p>
<p><span class="math display">\[  \text{log} \lambda_i(t) = \alpha + \beta_1x_{i1} + ...                   \]</span></p>
<p>or equivalently, $ _i(t) = (+ <em>1x</em>{i1} + …) $.</p>
<p><strong>Note:</strong> The <span class="math inline">\(\alpha\)</span> in this multiplicative version represents some sort a <em>baseline</em>. If all <span class="math inline">\(x_i\)</span>’s are zero, then the logarithm of hazard equals <span class="math inline">\(e^\alpha\)</span>. The good part of this family of models is it allows for this baseline to remain unspecified (or we don’t necessarily need to compute the coefficient for this intercept-like term).This makes the model <em>semi-parametric</em>.</p>
<p>The second key aspect of the Cox model is the <strong>proportionality</strong>. This means that <em>hazard ratios</em> of say two observations are <em>independent of time</em>. The <span class="math inline">\(\beta\)</span>s are estimated using proportionalily. This means that the coefficients are interpreted differently (see below). A value <span class="math inline">\(\beta\)</span> greater than zero, or equivalently a hazard ratio greater than one, indicates that as the value of the ith covariate increases, the event hazard increases and thus the length of survival decreases. Put another way, a hazard ratio above 1 indicates a covariate that is positively associated with the event probability, and thus negatively associated with the length of survival.</p>
<p>In summary,</p>
<ul>
<li>HR = 1: No effect</li>
<li>HR &lt; 1: Reduction in the hazard</li>
<li>HR &gt; 1: Increase in Hazard</li>
</ul>
<div id="fitting-the-model" class="section level2">
<h2>Fitting the model</h2>
<p>The <code>coxph</code> function is used to estimate the coefficients of the parameters. The <code>summary</code> call then shows all the estimates along with the following output:</p>
<pre class="r"><code>cox.fit &lt;- coxph(formula = Surv(time,status)~.,
                 data = data[,-1],
                 ties = &quot;efron&quot;)

summary(cox.fit)</code></pre>
<pre><code>## Call:
## coxph(formula = Surv(time, status) ~ ., data = data[, -1], ties = &quot;efron&quot;)
## 
##   n= 192, number of events= 139 
## 
##              coef  exp(coef)   se(coef)      z Pr(&gt;|z|)    
## inst   -0.0407864  0.9600342  0.0555278 -0.735   0.4626    
## sex    -0.3031563  0.7384836  0.2077356 -1.459   0.1445    
## treatm  0.1153139  1.1222257  0.1763759  0.654   0.5132    
## grade  -0.1697348  0.8438886  0.1348991 -1.258   0.2083    
## age    -0.0009324  0.9990680  0.0086164 -0.108   0.9138    
## cond    0.9144639  2.4954371  0.1523929  6.001 1.96e-09 ***
## site   -0.0506363  0.9506244  0.0740743 -0.684   0.4942    
## tstage  0.2650927  1.3035517  0.1198984  2.211   0.0270 *  
## nstage  0.1546905  1.1672966  0.0774096  1.998   0.0457 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##        exp(coef) exp(-coef) lower .95 upper .95
## inst      0.9600     1.0416    0.8610     1.070
## sex       0.7385     1.3541    0.4915     1.110
## treatm    1.1222     0.8911    0.7942     1.586
## grade     0.8439     1.1850    0.6478     1.099
## age       0.9991     1.0009    0.9823     1.016
## cond      2.4954     0.4007    1.8511     3.364
## site      0.9506     1.0519    0.8222     1.099
## tstage    1.3036     0.7671    1.0306     1.649
## nstage    1.1673     0.8567    1.0030     1.359
## 
## Concordance= 0.691  (se = 0.027 )
## Rsquare= 0.208   (max possible= 0.999 )
## Likelihood ratio test= 44.83  on 9 df,   p=9.94e-07
## Wald test            = 52.47  on 9 df,   p=3.69e-08
## Score (logrank) test = 56.79  on 9 df,   p=5.556e-09</code></pre>
<p>The Cox regression results can be interpreted as follow:</p>
<ul>
<li><p><strong>Statistical significance:</strong> The is the column under “z” and it corresponds to the ratio of each regression coefficient to its standard error (z = coef/se(coef)). This signifies, whether the coefficient of a given variable is statistically significantly different from 0.</p></li>
<li><p><strong>The regression coefficients signs:</strong> A positive sign means that the hazard is higher, and this suggests that with the increase of the variable the hazard increases. For categorical variables the Cox model gives the hazard ratio (HR) for the one group relative to the other group. The beta coefficient for sex = -0.3 indicates that females have <em>lower</em> risk of death (lower survival rates) than males.</p></li>
<li><p><strong>Hazard ratios:</strong> The exponentiated coefficients in the second column of the first panel (and in the first column of the second panel) of the output are interpretable as multiplicative effects on the hazard. Thus, for example, holding the other covariates constant, an additional year of age reduces the yearly hazard of rearrest by 73 percent. a factor of</p></li>
<li><p><strong>Confidence intervals:</strong> of the hazard ratios. The summary output also gives upper and lower 95% confidence intervals for the hazard ratio (exp(coef))</p></li>
<li><p><strong>Global statistical significance of the model:</strong> The likelihood-ratio, Wald, and score chi-square statistics at the bottom of the output are asymptotically (for large enough N, they will give similar results. For small N, they may differ somewhat) equivalent tests of the omnibus null hypothesis that all of the ??’s are zero. In this instance, the test statistics are in close agreement, and the hypothesis is soundly rejected.</p></li>
</ul>
</div>
<div id="survival-curves" class="section level2">
<h2>Survival curves</h2>
<p>One can extract the survival probabilities from the cox object in R and simultaneously plot it using the <code>ggsurvplot</code> function.</p>
<pre class="r"><code>survminer::ggsurvplot(survfit(cox.fit), color = &quot;#2E9FDF&quot;,ggtheme = theme_minimal())</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="assumption-checking" class="section level2">
<h2>Assumption Checking</h2>
<p>In order to check these model assumptions, Residuals method are used. The common residuals for - the Cox model include:</p>
<ul>
<li><strong>Schoenfeld residuals</strong> to check the proportional hazards assumption</li>
<li><strong>Martingale residual</strong> to assess nonlinearity</li>
<li><p><strong>Deviance residuals</strong> (symmetric transformation of the Martingale residuals), to examine influential observations</p></li>
<li><p><strong>Proportionality:</strong> The proportional hazards (PH) assumption can be checked using statistical tests and graphical diagnostics based on the scaled Schoenfeld residuals. In principle, the Schoenfeld residuals are independent of time. A plot that shows a non-random pattern against time is evidence of violation of the PH assumption. The function <code>cox.zph</code> provides a convenient solution to test the proportional hazards assumption for each covariate included in a Cox regression model fit. For each covariate, the function <code>cox.zph</code> correlates the corresponding set of scaled Schoenfeld residuals with time, to test for independence between residuals and time. Additionally, it performs a global test for the model as a whole. The proportional hazard assumption is supported by a non-significant relationship between residuals and time, and refuted by a significant relationship.</p></li>
</ul>
<pre class="r"><code>cox.fit &lt;- coxph(formula = Surv(time,status)~ sex + treatm,
                 data = data[,-1],
                 ties = &quot;efron&quot;)

cox.zph(cox.fit)</code></pre>
<pre><code>##            rho  chisq     p
## sex    -0.0227 0.0734 0.786
## treatm -0.0961 1.2965 0.255
## GLOBAL      NA 1.3270 0.515</code></pre>
<p>From the output above, the test is not statistically significant for each of the covariates, and the global test is also not statistically significant. Therefore, we can assume the proportional hazards. It’s possible to do a graphical diagnostic using the function <code>ggcoxzph</code>, which produces, for each covariate, graphs of the scaled Schoenfeld residuals against the transformed time.</p>
<pre class="r"><code>survminer::ggcoxzph(cox.zph(cox.fit))</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>In the figure above, the solid line is a smoothing spline fit to the plot, with the dashed lines representing a +/- 2-standard-error band around the fit. Note that, systematic departures from a horizontal line are indicative of non-proportional hazards, since proportional hazards assumes that estimates do not vary much over time. From the graphical inspection, there is no pattern with time. The assumption of proportional hazards appears to be supported for the covariates sex (which is, recall, a two-level factor, accounting for the two bands in the graph), wt.loss and age.</p>
<p>A violations of proportional hazards assumption can be resolved by: - Adding covariate*time interaction - Stratification - Stratification is useful for “nuisance” con founders, where you do not care to estimate the effect. You cannot examine the effects of the stratification variable (John Fox &amp; Sanford Weisberg).</p>
<ul>
<li><strong>Influential Observations:</strong> To test influential observations or outliers, we can visualize either the deviance residuals or the dfbeta values. The function <code>ggcoxdiagnostics</code> provides a convenient solution for checking influential observations. The simplified format is as follows:</li>
</ul>
<pre class="r"><code>survminer::ggcoxdiagnostics(cox.fit, type = &quot;martingale&quot; ,linear.predictions = F, ggtheme = ggplot2::theme_minimal())</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Specifying the argument type = “dfbeta”, plots the estimated changes in the regression coefficients upon deleting each observation in turn; likewise, type=“dfbetas” produces the estimated changes in the coefficients divided by their standard errors.</p>
<p>For example:</p>
<pre class="r"><code>survminer::ggcoxdiagnostics(cox.fit, type = &quot;dfbeta&quot; ,linear.predictions = F, ggtheme = ggplot2::theme_minimal())</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>The above index plots show that comparing the magnitudes of the largest dfbeta values to the regression coefficients suggests that none of the observations is terribly influential individually</p>
<p>It’s also possible to check outliers by visualizing the deviance residuals. The deviance residual is a normalized transform of the martingale residual. These residuals should be roughly symmetrically distributed about zero with a standard deviation of 1. Positive values correspond to individuals that “died too soon” compared to expected survival times. Negative values correspond to individual that “lived too long”. Very large or small values are outliers, which are poorly predicted by the model. Example of deviance residuals:</p>
<pre class="r"><code>survminer::ggcoxdiagnostics(cox.fit, type = &quot;deviance&quot; ,linear.predictions = F, ggtheme = ggplot2::theme_minimal())</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<ul>
<li><strong>Non-linearity:</strong>Often, we assume that continuous covariates have a linear form. However, this assumption should be checked. Plotting the Martingale residuals against continuous covariates is a common approach used to detect nonlinearity or, in other words, to assess the functional form of a covariate. For a given continuous covariate, patterns in the plot may suggest that the variable is not properly fit. Nonlinearity is not an issue for categorical variables, so we only examine plots of martingale residuals and partial residuals against a continuous variable.</li>
</ul>
<p>Martingale residuals may present any value in the range (-INF, +1) and a value of martingale residuals near 1 represents individuals that “died too soon”, and large negative values correspond to individuals that “lived too long”. To assess the functional form of a continuous variable in a Cox proportional hazards model, we’ll use the function <code>ggcoxfunctional</code>.</p>
<p>The function displays graphs of continuous covariates against martingale residuals of null cox proportional hazards model. This might help to properly choose the functional form of continuous variable in the Cox model. Fitted lines with lowess function should be linear to satisfy the Cox proportional hazards model assumptions.</p>
<pre class="r"><code>survminer::ggcoxfunctional(formula = Surv(time,status)~ age + log(age) + sqrt(age), data = data)</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="prediction" class="section level2">
<h2>Prediction</h2>
<pre class="r"><code>train_test_split &lt;- function(data,percent,seed){
  set.seed(seed)
  rows = sample(nrow(data))
  data &lt;- data[rows,]
  split = round(nrow(data)*percent)
  list(train = data[1:split,], test =  data[(split+1):nrow(data),])
}

list &lt;- train_test_split(data,0.6,66)
train &lt;- list$train; test &lt;- list$test

cox.fit2 &lt;- coxph(formula = Surv(time,status)~.,data = train)

# predict the survival
predictions &lt;- survfit(cox.fit2, newdata = test)</code></pre>
</div>
<div id="visualize-the-predictions" class="section level2">
<h2>Visualize the predictions</h2>
<pre class="r"><code># transponse the frame
survival.prediction &lt;- data.frame(t(predictions$surv))
# add IDs
survival.prediction &lt;- cbind(id = test$case,survival.prediction)
# rename column
colnames(survival.prediction) &lt;- c(&quot;id&quot;,round(predictions$time,3))

survival.prediction %&gt;%
        gather(key,value,-id) %&gt;%
        mutate(key = as.numeric(key)) %&gt;%
        ggplot(aes(x = key, y = value, group = id))+
        geom_line(alpha = 0.25)+
        theme_minimal()+
        labs(y = &quot;Probability&quot;,x = &quot;Time&quot;, title = &quot;Survival vs Time&quot;)+
        theme(axis.text.x = element_blank())+
        scale_x_continuous(breaks = c(0.203,3.608,0.5))</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code># using pec

predictions.pec &lt;- pec::predictSurvProb(cox.fit2, newdata = test, times = km.fit$time)</code></pre>
<p><strong>Cumulative Hazard</strong> at time <em>t</em> can also be extracted using the <code>cumhaz</code> component.</p>
<pre class="r"><code>hazard.prediction &lt;- predictions$cumhaz # hazard</code></pre>
</div>
<div id="validating-the-predicton" class="section level2">
<h2>Validating the predicton</h2>
<p>A measure used to assess the strength of a risk classification system is discrimination, and when the outcome is survival time, the most commonly applied global measure of discrimination is the concordance probability. The concordance probability represents the pairwise probability of lower patient risk given longer survival time. It is the fraction of pairs in your data, where the observation with the higher survival time has the higher probability of survival predicted by your model.</p>
<p>The Brier score is a proper score function that measures the accuracy of probabilistic predictions (<a href="https://en.wikipedia.org/wiki/Brier_score">wikipedia</a>). Evaluating the performance of risk prediction models in survival analysis. The Brier score is a weighted average of the squared distances between the observed survival status and the predicted survival probability of a model. Roughly the weights correspond to the probabilities of not being censored. The weights can be estimated depend on covariates. Prediction error curves are obtained when the Brier score is followed over time. Cross-validation based on bootstrap resampling or bootstrap subsampling can be applied to assess and compare the predictive power of various regression modelling strategies on the same set of data.. We can calculate the Brier Scores for our model and compare it against a reference model (without covariates) and compare the performance.</p>
<pre class="r"><code>library(pec)
library(prodlim)
library(riskRegression)
set.seed(17)

cindex &lt;- cindex(list(cox.fit2),
                   formula = Hist(time,status) ~ 1,
                   data = data,
                   splitMethod=&quot;bootcv&quot;,
                   M=round(NROW(data)*.6),
                   B=100,
                   cens.model=&quot;marginal&quot;)

(cindex$BootCvCindex$coxph)</code></pre>
<pre><code>## [1] 0.6258364</code></pre>
<pre class="r"><code>Brier  &lt;- pec(list(cox.fit2),
                   formula = Hist(time,status) ~ 1,
                   data = data,
                   splitMethod=&quot;bootcv&quot;,
                   M=round(NROW(data)*.6),
                   B=100,
                   cens.model=&quot;marginal&quot;)</code></pre>
<pre class="r"><code>reference &lt;- Brier$BootCvErr$Reference
cox &lt;- Brier$BootCvErr$coxph
err.frame &lt;- data.frame(reference,cox,time=Brier$time)
err.frame &lt;- err.frame[1:171,]
err.frame.long &lt;- gather(err.frame,key,value,-time)
ggplot(err.frame.long, aes(x = time, y = value, col = key))+
  geom_line()+
  scale_color_manual(&quot;Metric&quot;,values =c(&quot;cox&quot;=&quot;red2&quot;,&quot;reference&quot;=&quot;navyblue&quot;))+
  theme_minimal()</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Clearly the model with all covariates have lower error rates than our reference model with no covariates. One can also check the accuracy of such models by examining the area under the curve by using ROC style analysis.</p>
</div>
</div>
<div id="additive-models" class="section level1">
<h1>Additive models</h1>
<p>Additive hazard or Aalen’s models are an alternative to proportional hazard models. Here the hazard model is more directly similar to a linear model. Here the covariates are allowed to vary over time. We can also allow the covariates to vary over time.</p>
<p><span class="math display">\[  \lambda(t|x(t)) = \beta_0(t) + \sum \beta_k(t)x_k(t)             \]</span></p>
<p>We can fit the additive model in R using the <code>aareg</code> function. Then we can use <code>autoplot</code> from ggfortify to investigate which coefficients may vary over time.</p>
<pre class="r"><code>additive &lt;- aareg(Surv(time,status)~., data = data)

additive</code></pre>
<pre><code>## Call:
## aareg(formula = Surv(time, status) ~ ., data = data)
## 
##   n= 192 
##     124 out of 128 unique event times used
## 
##              slope      coef se(coef)      z        p
## Intercept -0.66200 -4.50e-03 6.56e-03 -0.686 4.93e-01
## case       0.00124  4.32e-06 1.38e-05  0.314 7.53e-01
## inst      -0.03510 -1.81e-04 4.72e-04 -0.383 7.02e-01
## sex       -0.31400 -3.08e-03 1.53e-03 -2.020 4.38e-02
## treatm     0.13700  1.19e-03 1.47e-03  0.812 4.17e-01
## grade     -0.19100 -1.70e-03 1.02e-03 -1.680 9.31e-02
## age       -0.00608 -1.64e-05 6.94e-05 -0.236 8.13e-01
## cond       2.59000  1.04e-02 2.39e-03  4.340 1.45e-05
## site      -0.03200 -3.25e-04 6.16e-04 -0.528 5.97e-01
## tstage     0.25100  2.16e-03 9.87e-04  2.180 2.89e-02
## nstage     0.22300  1.58e-03 6.89e-04  2.290 2.21e-02
## 
## Chisq=35.19 on 10 df, p=0.00012; test weights=aalen</code></pre>
<pre class="r"><code>autoplot(additive)+
  theme_minimal()+
  theme(legend.position = &quot;top&quot;)</code></pre>
<p><img src="/post/2018-01-14-death-note-part-i_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Sex might vary over time. This is evident from the steep slope in comparison with the rest.</p>
<p>There are several other survival models for instance, accelerated failure time (AFT) model that model survival information using distributions. Part 2 of this tutorial is coming up next where I will demonstrate how to construct survival trees and forests.</p>
</div>

      </div>

      


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/survival-analysis">survival analysis</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/ggplot2">ggplot2</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/r">R</a>
  
</div>



    </div>
  </div>

</article>



<div class="article-container article-widget">
  <div class="hr-light"></div>
  <h3>Related</h3>
  <ul>
    
    <li><a href="/post/jack-and-rose/">Jack and Rose</a></li>
    
    <li><a href="/post/what-s-in-a-basket/">What&#39;s In A Basket</a></li>
    
    <li><a href="/project/owens-illinoise-student-case-competition/">Owens Illinois Student Case Competition</a></li>
    
    <li><a href="/post/of-fortune-tellers-and-crystal-balls/">Of Fortune Tellers and Crystal Balls</a></li>
    
    <li><a href="/post/nobel-laureates/">Nobel Laureates</a></li>
    
  </ul>
</div>




<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

